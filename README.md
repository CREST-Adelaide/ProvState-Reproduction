# ProvState Framework Prototype

This prototype was developed by The Centre for Research on Engineering Software Technologies (CREST) https://crest-centre.net. 

This prototype demonstrate a concrete instantiation of the ProvState frameworkin the domain of software security. Each digital asset in this prototype represents a software security, which represents a change applied to the software code to correct the security weakness discovered by a vulnerability. 

Enterprise security patch management is a complex and challenging process that involves multiple departments or even organisations. The ProvState prototype provides a secure and decentralised infrastructure to track, records, and make decisions on lifecycle events of software security patches. Every interaction with the assets via ProvState is assessed and authorised by secure smart contracts and recorded in a tamper-resistant manner in a blockchain for future analysis and investigation.

## Installation

Prerequisites:
- URL to the JSON-RPC API of an Ethereum node
- Private key of a funded Ethereum account on the Ethereum network that you want to use as the back-end of your ProvState deployment

The easiest way to try this prototype is within a Docker container, using the `Dev Containers` extension of Visual Studio Code IDE. You can use a simulated blockchain such as [Ganache](https://trufflesuite.com/ganache/) as the blockchain network to try the prototype. 

Process: 
1. Install and start [Ganache](https://trufflesuite.com/ganache/) on your computer
2. Update the `manager_depl_key` field in the `/workspace/ProvStateConfig.json` configuration file to be the private key of one of the test accounts created by Ganache
3. Setup your VS Code for [developing inside a container](https://code.visualstudio.com/docs/remote/containers)
4. In your VS Code, open the command panel (Cmd + Shift + P) and find the Rebuild and Reopen in Container option. VS Code would build a Docker container with all the dependencies for Ruby and Node and reopen the source code inside the container. 
5. Install and switch to Ruby 2.6.6 with `rvm install ruby-2.6.6`
6. Install ruby dependencies using `bundle install`
7. Install node dependencies using `npm install` and `yarn install --check-files`
8. Prepare the postgres database using `rails db:setup` and `rails db:migrate`
9. Run `./start.sh` to boot the ProvState node. The script should deploy the `Manager` contract on you chosen blockchain, generate the necessary configuration file, and start the ruby application. The app is available at `localhost:3000`

## Usage

1. Create an account. The address and private keys can be retrieved from the test accounts generated by Ganache. This private key will be used to issue requests.
2. After logging in, get started by creating a group. Each group represents a group of participants that jointly manage a type of asset. 
3. After creating a group, use the `Oracle` to declare possible states and state transitions for assets managed by the group. Each transition can be constrained to a particular type of account only. 
4. Use the `States` tab to set the default initial state and final state for every assets created in this group. 
5. Use the `Assets` tab to declare new assets. You can upload the binary of the assets themselves to the platform for storage. 
6. Use the `States` tab to declare new actions (transitioning a particular asset to a destination state). The `Oracle` smart contract on blockchain enables only valid transitions to happen. Regardless of the validity, all requested state transition are stored in the blockchain for future analysis. 

Noted that the manual transitions using the web front-end is only for demonstrate purpose. In an actual deployment, the transition should be triggered by external systems by sending REST POST requests to the ProvState node.